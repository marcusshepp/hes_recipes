<!DOCTYPE html>
<html>
<head>
<title>Recipes</title>
<link rel="stylesheet" type="text/css" href="/stylesheets/application.css" />
<%= csrf_meta_tags %>
</head>
<body>
    <div class="nav_container">
        <div class="nav_btn title">
            HES Recipes
        </div>
        <a href="http://127.0.0.1:3000/recipes">
            <div class="nav_btn">
                All Recipes
            </div>
        </a>
        <a href="http://127.0.0.1:3000/recipes/new">
            <div class="nav_btn">
                Create New Recipe
            </div>
        </a>
    </div>
    <div class="main">
        <div class="content">
            <%= yield %>
        </div>
        <div class="footer">
            &copy; 2012 Health Enhancement Systems
        </div>
    </div>

<script type="text/javascript" src="/javascripts/jquery-1.8.0.min.js"></script>
<script type="text/javascript" src="/javascripts/jquery.colorbox-min.js"></script>
<script type="text/javascript">
    function delete_recipe(id){
        $.ajax({
            method: "GET",
            url: "http://127.0.0.1:3000/recipes/"+id+"/?delete",
            success: function(data){
                window.location = "http://127.0.0.1:3000/recipes/";
                console.log("success");
            },
        });
    }
    function toggle_steps_ingredients_all(){
        var container_elem = $('.steps_ingredients_all');
        if (container_elem.hasClass("hide")){
            container_elem.removeClass("hide"); 
            container_elem.addClass("display"); 
        } else {
            container_elem.addClass("hide"); 
            container_elem.removeClass("display"); 
        }
        
    }
    var number_of_ingredients = 1;
    var number_of_steps = 1;
    function add_new_dependency(type){
        var markup = '';
        if (type == "ing"){
            number_of_ingredients += 1;
            console.log(number_of_ingredients);
            for(var i = 0; i < number_of_ingredients; i++){
                markup += '\
                <div class="ingredient ingredient'+(i+1)+'">\
                <div class="indiv_dep_header">Ingredient '+(i+1)+'<span onclick="delete_dependency(\'ing\', \''+(i+1)+'\')">Delete</span></div>\
                <input type="text" name="ingredient[item]" class="recipe_form_dependency_input" \
                    max_length="100">\
                <input type="hidden" name="ingredient[recipe_id]" value="1">\
                <input type="number" name="ingredient[sequence]" value="1" class="recipe_form_dependency_input">\
                </div>\
                ';
            }
            $(".ingredients_container").html(markup);
        } else {
            number_of_steps += 1;
            console.log(number_of_steps);
            for(var i = 0; i < number_of_steps; i++){
                markup += '\
                <div class="step step'+(i+1)+'">\
                    <div class="indiv_dep_header">Step '+(i+1)+'<span onclick="delete_dependency(\'step\', \''+(i+1)+'\')">Delete</span></div>\
                    <input type="text" name="step[description]" class="recipe_form_dependency_input" \
                        max_length="100">\
                    <input type="hidden" name="step[recipe_id]" value="1">\
                    <input type="number" name="step[sequence]" value="1" class="recipe_form_dependency_input">\
                </div>\
                ';
            }
            $(".steps_container").html(markup);
        }
    }
    function delete_dependency(type, id){
        if (type == "ing"){
            var element = $(".ingredient"+id);
            element.html("");
            number_of_ingredients -= 1;
        } else {
            var element = $(".step"+id);
            element.html("");
            number_of_steps -= 1;
        }
    }
</script>
</body>
</html>
